{"ast":null,"code":"import { IsLoggedHeaderComponent } from \"../../components/header/is-logged-header/is-logged-header.component\";\nimport { IsUnLoggedHeaderComponent } from \"../../components/header/is-un-logged-header/is-un-logged-header.component\";\nimport { FooterComponent } from \"../../components/footer/footer.component\";\nimport { CommonModule } from '@angular/common';\nimport { take } from 'rxjs/operators';\nimport { MovieCardComponent } from \"../../components/movie-card/movie-card.component\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/RecommendationService.service\";\nimport * as i2 from \"../../services/movie.service\";\nimport * as i3 from \"../../services/auth.service\";\nimport * as i4 from \"@angular/common\";\nfunction RecommendedPageComponent_app_is_logged_header_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-is-logged-header\");\n  }\n}\nfunction RecommendedPageComponent_app_is_un_logged_header_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-is-un-logged-header\");\n  }\n}\nfunction RecommendedPageComponent_app_movie_card_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-movie-card\", 6);\n  }\n  if (rf & 2) {\n    const movie_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"movie\", movie_r1);\n  }\n}\nfunction RecommendedPageComponent_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function RecommendedPageComponent_button_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.loadMore());\n    });\n    i0.ɵɵtext(1, \" Load More \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let RecommendedPageComponent = /*#__PURE__*/(() => {\n  class RecommendedPageComponent {\n    recommendationService;\n    userService;\n    authService;\n    isLoggedIn = false;\n    recommendedMovies = [];\n    currentPage = 1;\n    hasMore = true;\n    userMovies = [];\n    constructor(recommendationService, userService, authService) {\n      this.recommendationService = recommendationService;\n      this.userService = userService;\n      this.authService = authService;\n    }\n    ngOnInit() {\n      this.authService.loggedIn$.pipe(take(1)).subscribe(status => {\n        this.isLoggedIn = status;\n        if (status) {\n          this.userMovies = [...this.userService.getFavorites(), ...this.userService.getWatched()];\n          this.loadRecommendations();\n        } else {\n          this.loadPopular();\n        }\n      });\n    }\n    loadPopular() {\n      this.recommendationService.getPopularMovies(this.currentPage).subscribe(movies => {\n        if (movies.length === 0) {\n          this.hasMore = false;\n        } else {\n          this.recommendedMovies = [...this.recommendedMovies, ...movies];\n        }\n      });\n    }\n    loadRecommendations() {\n      console.log('userMovies:', this.userMovies);\n      this.recommendationService.getRecommendations(this.userMovies, this.currentPage).subscribe(movies => {\n        if (movies.length === 0) {\n          this.hasMore = false;\n        } else {\n          this.recommendedMovies = [...this.recommendedMovies, ...movies];\n        }\n      });\n    }\n    loadMore() {\n      this.currentPage++;\n      this.isLoggedIn ? this.loadRecommendations() : this.loadPopular();\n    }\n    static ɵfac = function RecommendedPageComponent_Factory(t) {\n      return new (t || RecommendedPageComponent)(i0.ɵɵdirectiveInject(i1.RecommendationService), i0.ɵɵdirectiveInject(i2.MovieService), i0.ɵɵdirectiveInject(i3.AuthService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: RecommendedPageComponent,\n      selectors: [[\"app-recommended-page\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 10,\n      vars: 4,\n      consts: [[1, \"container\"], [4, \"ngIf\"], [1, \"recommended-page\"], [1, \"movie-list\"], [3, \"movie\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"load-more\", 3, \"click\", 4, \"ngIf\"], [3, \"movie\"], [1, \"load-more\", 3, \"click\"]],\n      template: function RecommendedPageComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementContainerStart(0, 0);\n          i0.ɵɵtemplate(1, RecommendedPageComponent_app_is_logged_header_1_Template, 1, 0, \"app-is-logged-header\", 1)(2, RecommendedPageComponent_app_is_un_logged_header_2_Template, 1, 0, \"app-is-un-logged-header\", 1);\n          i0.ɵɵelementStart(3, \"div\", 2)(4, \"h2\");\n          i0.ɵɵtext(5, \"Recommended for You\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"div\", 3);\n          i0.ɵɵtemplate(7, RecommendedPageComponent_app_movie_card_7_Template, 1, 1, \"app-movie-card\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(8, RecommendedPageComponent_button_8_Template, 2, 0, \"button\", 5);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(9, \"app-footer\");\n          i0.ɵɵelementContainerEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoggedIn);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoggedIn);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngForOf\", ctx.recommendedMovies);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.hasMore);\n        }\n      },\n      dependencies: [IsLoggedHeaderComponent, IsUnLoggedHeaderComponent, FooterComponent, CommonModule, i4.NgForOf, i4.NgIf, MovieCardComponent],\n      styles: [\".recommended-page[_ngcontent-%COMP%]{color:#fff;padding-top:150px;padding-left:80px}.recommended-page[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-size:2rem}.recommended-page[_ngcontent-%COMP%]   .movie-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem;justify-content:center}.recommended-page[_ngcontent-%COMP%]   app-movie-card[_ngcontent-%COMP%]{flex:0 1 250px}.load-more[_ngcontent-%COMP%]{margin:2rem auto;display:block;padding:.75rem 2rem;background-color:#ff3c38;color:#fff;border:none;border-radius:10px;font-size:1rem;cursor:pointer;transition:background-color .3s ease}.load-more[_ngcontent-%COMP%]:hover{background-color:#ff1f1a}\"]\n    });\n  }\n  return RecommendedPageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}